/*!*******************************************
* css-to-xpath-converter 1.0.0
* https://github.com/angezid/css-to-xpath-converter
* MIT licensed
* Copyright (c) 2024â€“2025, angezid
*********************************************/
function e(t){this.axis="",this.separator="",this.owner="",this.parentNode=t,this.previousNode,this.childNodes,this.content,this.addChild=function(e){this.childNodes||(this.childNodes=[]),this.childNodes.push(e)},this.add=function(){let e="",t=!1;for(let n=0;n<arguments.length;n++)n===arguments.length-1&&"boolean"==typeof arguments[n]?t=!0:e+=arguments[n];this.content||(this.content=[]),this.content.push({str:e,forbid:t})},this.hasAxis=function(e){if(this.axis===e)return!0;if(this.childNodes)for(let t=0;t<this.childNodes.length;t++)if(this.childNodes[t].hasAxis(e))return!0;return!1},this.clone=function(){const t=new e;return t.owner=this.owner,t.isClone=!0,t},this.toString=function(e=""){if(!this.isClone&&(e=this.separator+this.axis+this.owner,this.content)){const n=this.content.length;if(1===n)e+=this.or?this.content[0].str:"["+t(this.content[0].str)+"]";else{let s=!1;for(let a=0;a<n;a++){const r=this.content[a],o=t(r.str),i=a+1===n;r.forbid?(e+="["+o+"]",s=!1):(e+=(s?" and ":"[")+o,a+1<n&&!this.content[a+1].forbid?(e+=i?"]":"",s=!0):(e+="]",s=!1))}}}function t(e){return e.replace(/\x01\[((?:[^"'\x01\x02]|"[^"]*"|'[^']*')+)\]\x02/g,"$1")}return this.childNodes&&this.childNodes.forEach((t=>{e+=t.toString(e)})),e}}function t(e,n,s,a,r){const o=new Error(s,a,r);return o.parser=!0,o.column=n,o.code=e,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,t),o}t.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,Error):t.__proto__=Error;const n=/(?:[a-zA-Z]+\|)?(?:[a-zA-Z][^ -,.\/:-@[-^`{-~]*)|(?:[a-zA-Z]+\|*)/y,s=/(?:^\\00003\d+)?(?:\\[^ ]|[^\t-,.\/:-@[-^`{-~])+/y,a=/((?:[a-z]+-)*[a-z]+)(?:([(])|(?=[ ,:+>~!^]|$))/y,r=/^([+-])?([0-9]+)?n(?:([+-])([0-9]+))?$/,o=/(?:(?:\*|[a-zA-Z]+)\|)?(?:\*|[^ -,.\/:-@[-^`{-~]+)/y,i=/(?:[a-zA-Z]+\|)?[^ -,.\/:-@[-^`{-~]+(?=(?:[~^|$!*]?=)|\])/y,c=/(?:"([^"]*)"|'([^']*)'|((?:\\[^ ]|[^ "'\]])+))(?: +([siSI]))?(?=\])/y,l=Object.freeze({Text:0,PseudoClass:1,AttributeName:2,AttributeValue:3}),d="Pseudo-class ':",u="preceding-sibling::",f="following-sibling::",h="ancestor::",p="\nSystem.Xml.XPath.XPathNavigator doesn't support '*' as a namespace.";let b,g,m,w,k,x,$,N,y;function A(t,n){ce(t),b=Object.assign({},{axis:".//",consoleUse:!1,standard:!1,removeXPathSpaces:!1,uppercaseLetters:"",lowercaseLetters:"",postprocess:!0,translate:!0,debug:!1},n),g="",m="",x=[];const s=new e;let a,r;try{w=b.uppercaseLetters?b.uppercaseLetters.trim():"",k=b.lowercaseLetters?b.lowercaseLetters.trim():"",w.length!==k.length&&fe("Custom letters have different length"),r=function(e){const t=",>+=~^!:([",n=",>+=~^!$]()";$=e,y=$.length;let s=!1,a=!1,r="\0";const o=[];for(let e=0;e<y;e++){const c=$[e];if(" "===c||/\s/.test(c)){if(a)continue;s&&(t.includes(r)?(s=!1,a=!1):a=!0)}else if("\\"===c)(e+1>=y||/\s/.test($[e+1]))&&he(e,c,"Non-escape character",$),o.push(c,$[++e]);else if("/"===c&&ie(e,"*")){e+=2;const t=i(e,c,!0);-1===t?o.push("/*"):e=t}else if('"'===c||"'"===c){const t=i(e,c,!1);-1!==t?(o.push($.substring(e,t+1)),e=t):he(e,c,"function normalizeWhiteSpaces()",$),s=!0,r=c}else!a||n.includes(c)||"*"===c&&ie(e,"=")||o.push(" "),o.push(c),s=!0,a=!1,r=c}function i(e,t,n){for(;++e<y;)if($[e]===t){if(n&&"*"!==$[e-1])continue;return e}return-1}return o.join("")}(t),a=S(s,r,b.axis,null),a=function(e){if(b.postprocess){b.removeXPathSpaces&&(e=e.replace(/("[^"]+"|'[^']+')|([,<=>|+-]) +| +(?=[<=>|+-])/g,((e,t,n)=>t||n||"")));const t=e.split(/(?<!\| *)(\bself::node\(\)\[)/g);e="";for(let n=0;n<t.length;n++)if("self::node()["===t[n]){const s=t[n+1],a=re(0,"["+s,!0,"[","]");if(a){const r=a.content,o=s.substr(a.index);v(r)||/^(?:\[| *\|)/.test(o)&&!r.endsWith("]")?e+=t[n]:(e+=r+o,n++)}}else e+=t[n];e=(e=(e=e.replace(/([[(])\{((?:[^'"{}]|"[^"]*"|'[^']*')+)\}([\])])/g,"$1$2$3")).replace(/([/:])\*\[self::(\w+)(\[(?:[^"'[\]]|"[^"]*"|'[^']*')+\])?\]/g,"$1$2$3")).replace(/\/child::/g,"/")}return e=e.replace(/(?:[^'"{}]|"[^"]*"|'[^']*')+|([{}])/g,((e,t)=>t?"{"===t?"(":")":e)),e}(a)}catch(e){return e.parser?b.debug&&console.log(e.message,e.code,e.column):console.error(e),{xpath:a,css:r,warning:g,error:e.message}}return{xpath:a,css:r,warning:g,error:m}}function z(e,t,n,s,a){t||fe("':"+a.name+"()' has missing argument"),x.push($);const r=S(e,t,n,s,a);return $=x.pop(),y=$.length,r}function v(e){const t=/(?:[^'" ]|"[^"]*"|'[^']*')+|( or )/g;let n;for(;n=t.exec(e);)if(n[1])return!0;return!1}function S(e,t,n,a,r){ce(t);let o=C(e,null),i=C(o,null);const c=r?r.name:"",d=r&&r.predicate,b="not"===c;let g,m=null,w=null,k=null,x=null,A=l.Text,z=!1,v=!0,S=-1,j=$[0];for($=t,y=$.length,(/^[,(]/.test($)||!c&&/^[>+~^!]/.test(j))&&X(),/[.#[:>+~^!]$/.test($)&&(j=$[y-1],X(y));++S<y;)if(N=S,j=$[S],A===l.Text){switch((z&&!/[>+~^!.#*:|[@a-zA-Z]/.test(j)||!z&&!/[ ,>+~^!.#*:|[@a-zA-Z]/.test(j))&&he(S,j,E(A)+", check="+z,$),r&&/!?[+~]/.test(j)&&c.endsWith("-sibling")&&fe("'"+c+"()' with these arguments has no implementation"),(/[.#:[]/.test(j)||"has"!==c&&i.previousNode&&/[>+~^!]/.test(j))&&(I(n,i,r),L(a,i)),j){case".":let t="";do{if([S,g]=ee(S+1),t+=R("@class",K(" "+g+" ")),s.lastIndex=S+2,!ie(S,".")||!s.test($))break;t+=" and "}while(++S<y);i.add(t),z=!1;break;case"#":[S,g]=ee(S+1),i.add("@id=",K(g)),z=!1;break;case">":i=b?P(o,i,"parent::"):C(o,i,"child::","/"),z=!0;break;case"+":i=O(o,i,b?u:f,"*","1"),z=!0;break;case"~":i=b?P(o,i,u):C(o,i,f,"/"),z=!0;break;case"^":i=b?P(o,i,"parent::",F(u)):O(o,i,"child::","*","1"),z=!0;break;case"!":ie(S,"^")?(i=b?P(o,i,"parent::",F(f)):O(o,i,"child::","*","last()"),S++):ie(S,"+")?(i=O(o,i,b?f:u,"*","1"),S++):ie(S,">")?(i=b?P(o,i,"child::"):C(o,i,"parent::","/"),S++):ie(S,"~")?(i=b?P(o,i,f):C(o,i,u,"/"),S++):i=b?P(o,i,"descendant-or-self::"):C(o,i,"ancestor-or-self::","/"),z=!0;break;case"[":m="",w=null,k=null,x=null,A=l.AttributeName;break;case":":ie(S,":")&&X(1),A=l.PseudoClass;break;case",":S+1>=y&&X(),o=C(e,o),o.or=!0,o.add(d?" or ":" | "),o=C(e,o),i=C(o,null,r?"":n),z=!0;break;case"@":[S,i]=Z(S,n,r,o,i),z=!1;break;case"*":I(n,i,r),i.owner="*",z=!1;break;case" ":r?"has-ancestor"===c?i=C(o,i,h," and "):["has-parent","before","after"].includes(c)||c.endsWith("-sibling")?(i.previousNode||(i.axis=h,i.separator=""),i=C(o,i,h," and ")):"not"===c&&"self::"===i.axis?(i.previousNode&&i.previousNode.axis===h&&(i.separator=" and "),i.and=!0,i=P(o,i,h)):i=C(o,i,null,"//"):i=C(o,i,null,"//"),z=!0;break;case"|":ie(S,"|")?X(1):[S,i]=T(S,n,v,o,i),z=!1;break;case"\\":S++;break;default:/[a-zA-Z]/.test(j)?(i.owner&&X(),I(n,i,r),S=Y(S,i)):X(),z=!1}v=!1}else if(A===l.AttributeName)switch(j){case"=":x="=",w=null,A=l.AttributeValue;break;case"!":case"~":case"^":case"$":case"*":case"|":ie(S,"=")?(x=j+"=",S++,w=null,A=l.AttributeValue):"*"===j&&ie(S,"|")?(m="*:",S++,le(p)):X();break;case"]":m||ue("attrName is null or empty.'"),i.add("@"+m),A=l.Text,z=!1;break;case" ":break;default:[S,g]=se(S),m+=g}else if(A===l.AttributeValue)switch(j){case"]":null===w&&ue("attrValue is null."),V(m,w,x,k,i),A=l.Text,z=!1;break;case"=":X();break;case" ":break;default:w&&ue("attrValue '"+w+"' is already parse: "+$.substring(S)),[S,w,k]=ae(S)}else if(A===l.PseudoClass){let e="",t="";[S,e,t]=te(S),"root"===e?(i.owner=i.separator="",i.axis="//",i=C(o,i,"ancestor-or-self::"),i.owner="*",i.add("last()")):(L(a,i),e.startsWith("nth-")?U(e,t,r,i):W(e,t,b,i)),A=l.Text,z=!1}let q=e.toString();function X(e){he(S+(e||0),j,E(A),$)}return(z||A!==l.Text)&&ue("Something is wrong: '"+E(A)+"', selector='"+$+"', xpath='"+q+"'"),q}function E(e){return"State."+Object.keys(l)[e]}function C(t,n,s,a){const r=new e(t);return t.addChild(r),r.previousNode=n,r.axis=s||"",a&&n.owner&&(r.separator=a),r}function P(e,t,n,s){"node()"===t.owner&&(t.owner="*"),t.axis=n;var a=C(e,t,"self::","/");return s&&a.add(s),a}function O(e,t,n,s,a){const r=C(e,t,n,"/");return r.owner=s,r.add(a,!0),C(e,r,"self::","/")}function I(e,t,n){if(!e||t.axis||"self::"===e&&!n)return;const s=t.parentNode.toString().trim();(0==s.length||j(s))&&(t.axis=e)}function L(e,t){if(t.owner)return;let n="";if(t.previousNode){const s=t.parentNode.toString().trim();if(s.length)if(j(s))n=e||"*";else{const t=s[s.length-1];e?":"===t?n="*":"/"===t&&(n=e):":"!==t&&"/"!==t||(n="*")}}else n=e||"*";t.owner=n}function j(e){return/(?: or|\|)$/.test(e)}function T(e,t,n,s,a){if("*"==a.owner)ie(e,"*")?(a.owner="*:*",e++):a.owner="*:",le(p);else if(n&&I(t,a),ie(e,"*"))a.owner?a.owner+=":*":(a.owner="*",a.add("not(contains(name(), ':'))")),e++;else{if(e+1<y&&/[a-zA-Z]/.test($[e+1])){let t=C(s,a,"self::","/");return t.owner="*",[e,t]}a.owner="*:",le(p)}return[e,a]}function Z(e,t,n,s,a){const r=a.parentNode.toString().trim();if(0===r.length)n&&(t="");else if(j(r))t="";else{const e=r[r.length-1];t=":"!==e&&"/"!==e?"/":""}o.lastIndex=e+1;const i=o.exec($);if(null!==i){const n=C(s,a,t);return n.add("@",i[0].replace("|",":").toLowerCase()),[e+i[0].length,n]}pe(e,"parseAttribute",o)}function V(e,t,n,s,a){if(!t.trim())return void("="===n?a.add("@",e," = ''"):"!="===n?a.add("{not(@",e,") or @",e," != ''}"):"|="===n?a.add("{@",e," = '' or starts-with(@",e,", '-')}"):a.add("false()",!0));const r="i"===s||"lang"===e||"type"===e&&"input"==ne(a);if(!b.standard&&"class"===e)return void function(e,t,n,s){const a=n?H("@class"):"@class";let r=e.trim();switch(t){case"=":case"~=":case"!=":r=" "+r+" ";break;case"^=":r=" "+r;break;case"$=":r+=" "}r=n?G(r):K(r);if("!="===t)s.add("{not(",a,") or not(",R(a,r),")}");else if("*="===t)s.add("contains(",a,", ",r,")");else if("|="===t){const t=n?G(" "+e+" "):K(" "+e+" "),r=n?G(" "+e+"-"):K(" "+e+"-");s.add("{",R(a,t)," or ",R(a,r),"}")}else s.add(R(a,r))}(t,n,r,a);const o=r?H("@"+e):null,i=K(t);switch(n){case"=":r?a.add(o," = ",G(t)):a.add("@",e,"=",i);break;case"!=":r?a.add("{not(@",e,") or ",o,"!=",G(t),"}"):a.add("{not(@",e,") or @",e,"!=",i,"}");break;case"~=":r?a.add("contains(concat(' ', normalize-space(",o,"), ' '), concat(' ', normalize-space(",G(t),"), ' '))"):a.add("contains(concat(' ', normalize-space(@",e,"), ' '), concat(' ', normalize-space(",i,"), ' '))");break;case"|=":r?a.add("{",o," = ",G(t)," or starts-with(",o,", concat(",G(t),", '-'))}"):a.add("{@",e," = ",i," or starts-with(@",e,", ",K(t+"-"),")}");break;case"^=":r?a.add("starts-with(",o,", ",G(t),")"):a.add("starts-with(@",e,", ",i,")");break;case"$=":r?a.add(q(o,"@"+e,i,G(t))):a.add(q("@"+e,"@"+e,i,i));break;case"*=":r?a.add("contains(",o,", ",G(t),")"):a.add("contains(@",e,", ",i,")")}}function q(e,t,n,s){return"substring("+e+", string-length("+t+") - (string-length("+n+") - 1)) = "+s}function R(e,t){return`contains(concat(' ', normalize-space(${e}), ' '), ${t})`}function W(e,t,n,s){let a,r,o,i,c="",l="local-name()";switch(e){case"any-link":s.add("(",l," = 'a' or ",l," = 'area') and @href");break;case"external":s.add("(",l," = 'a' or ",l," = 'area') and (starts-with(@href, 'https://') or starts-with(@href, 'http://'))");break;case"contains":s.add("contains(normalize-space(), ",J(t,e),")");break;case"icontains":s.add("contains(",G(),", ",m(t),")");break;case"empty":s.add("not(*) and not(text())");break;case"dir":i=K(t);const w=/ltr/.test(i);s.add(w?"{not(ancestor-or-self::*[@dir]) or ":"","ancestor-or-self::*[@dir][1][@dir = ",i,"]",w?"}":"");break;case"first-child":s.add(F(u));break;case"first":n?s.add(t?g(u," <= "):F(u)):s.add(t?"position() <= "+Q(t,e):"1",!t);break;case"first-of-type":o=ne(s,e),s.add(F(u,o));break;case"gt":case"skip":n?s.add(g(u," > ")):s.add("position() > ",Q(t,e));break;case"lt":n?s.add(g(u," <= ")):s.add("position() < ",Q(t,e));break;case"eq":case"nth":n?s.add(g(u," = ")):s.add(Q(t,e));break;case"last-child":s.add(F(f));break;case"only-child":s.add("not(",u,"*) and not(",f,"*)");break;case"only-of-type":o=ne(s,e),s.add("not(",u,o,") and not(",f,o,")");break;case"text":s.add("@type='text'");break;case"starts-with":s.add("starts-with(normalize-space(), ",J(t,e),")");break;case"istarts-with":s.add("starts-with(",G(),", ",m(t),")");break;case"ends-with":c=J(t,e),s.add(q("normalize-space()","normalize-space()",c,c));break;case"iends-with":c=m(t),s.add(q(G(),"normalize-space()",c,c));break;case"is":case"matches":a=s.clone(),r=z(a,t,"self::","node()",{predicate:!0,name:e}),s.add(r);break;case"not":a=s.clone(),r=z(a,t,"self::","node()",{name:e}),"self::node()"!==r&&(r=function(e){let t="";return e.childNodes.forEach((e=>{if(e.childNodes){let n="",s="",a=!1;for(let t=e.childNodes.length-1;t>=0;t--){const r=e.childNodes[t];a?(r.separator="",n+="["+r.toString(),s+="]"):(r.separator&&(a=!0,r.separator=""),n+=r.toString())}t+=n+s}else t+=e.toString()})),t}(a),s.add("not("+r+")"));break;case"has":a=s.clone(),r=z(a,t,".//",null,{name:e}),s.add(r);break;case"has-sibling":a=s.clone();let k=z(a,t,u,null,{name:e});a.hasAxis(h)&&(k=X(a,u)),a=s.clone();let x=z(a,t,f,null,{name:e});a.hasAxis(h)&&(x=X(a,f)),s.add("{(",k,") or (",x,")}");break;case"has-parent":p("parent::");break;case"has-ancestor":a=s.clone(),r=z(a,t,h,null,{name:e}),s.add(r);break;case"after":p("preceding::");break;case"after-sibling":p(u);break;case"before":p("following::");break;case"before-sibling":p(f);break;case"last":n?s.add(t?g(f," <= "):F(f)):s.add(t?"position() > last() - "+Q(t,e):"last()",!t);break;case"last-of-type":o=ne(s,e),s.add(F(f,o));break;case"skip-first":n?s.add(t?g(u," > "):F(u)):s.add("position() > ",t?Q(t,e):"1",!t);break;case"skip-last":n?s.add(t?g(f," > "):F(f)):s.add("position() < last()",t?" - "+(Q(t,e)-1):"");break;case"limit":n?s.add(g(u," <= ")):s.add("position() <= ",Q(t,e));break;case"lang":c=function(e,t){const n=H("@lang",!0),s=t.split(",");let a="";for(let t=0;t<s.length;t++){t>0&&(a+=" or "),a+="ancestor-or-self::*[@lang][1][";const l=/^([a-z]+|\*)(?:-([a-z]+|\*))?(?:-([a-z]+|\*))?/i.exec(oe(s[t].trim()));if(l){if("*"===l[1])if(r(l[2]))a+=i(l[2]+(r(l[3])?"-"+l[3]:""));else{if(!r(l[3]))return"";a+=i(l[3])}else if("*"===l[2]){const e=c(l[1]+"-");r(l[3])?a+="starts-with("+n+", "+e+") and ("+i(l[3])+")":a+=o(l[1])}else{a+=o(l[1]+(l[2]?"-"+l[2]:"")+(r(l[3])?"-"+l[3]:""))}a+="]"}else fe(d+e+"()' has wrong arguments")}function r(e){return e&&"*"!==e}function o(e){const t=c(e);return n+" = "+t+" or starts-with("+n+", concat("+t+", '-'))"}function i(e){const t=c("-"+e+"-"),s=c("-"+e);return"contains(substring("+n+", string-length(substring-before("+n+", "+t+"))), "+t+") or "+q(n,"@lang",s,s)}function c(t){return t=K(t,e),b.translate?H(t,!0):t}return a}(e,t),c&&s.add("{",c,"}");break;case"range":const $=t.split(",");2!==$.length&&fe(d+e+"(,)' is required two numbers");const N=Q($[0],e),y=Q($[1],e);N>=y&&fe(d+e+"("+N+", "+y+")' have wrong arguments"),n?(c=M(u,"*",{count:N-1,comparison:" >= "})+" and ",c+=M(u,"*",{count:y-1,comparison:" <= "}),s.add(c)):s.add("position() >= ",N," and position() <= ",y);break;case"target":s.add("starts-with(@href, '#')");break;case"disabled":s.add("@disabled");break;case"enabled":s.add("not(@disabled)");break;case"selected":s.add(l," = 'option' and @selected");break;case"checked":s.add("(",l," = 'input' and (@type='checkbox' or @type='radio') or ",l," = 'option') and @checked");break;default:ue(d+e+"' is not implemented")}function p(n){const a=s.clone();let r=z(a,t,n,null,{name:e});a.hasAxis(h)&&(r=X(a,n)),s.add(r)}function g(n,s){return M(n,"*",{count:Q(t,e)-1,comparison:s})}function m(t){const n=J(t,e);return b.translate?H(n):n}}function X(e,t){let n="";return e.childNodes.forEach((e=>{if(e.hasAxis(h)){let s="";const a=e.childNodes.length-1;e.childNodes.forEach(((e,n)=>{n<a?s+=e.toString():(e.axis=t,e.separator="",s=e.toString()+"["+s+"]")})),n+=s}else n+=e.toString()})),n}function U(e,t,n,s){ce(t);let a,r="*",o="";if("nth-child"===e||"nth-last-child"===e){const n=function(e,t,n){let s,a="*";const r=/ +of +(.+)$/,o=r.exec(t);if(null!==o){const i=n.clone();s=z(i,o[1],"self::","node()",{predicate:!0,name:e});let c="";return i.childNodes.forEach((e=>{const t=e.toString();if(e.childNodes){const n=e.childNodes[0];"node()"===n.owner?(n.axis="",n.owner="",c+=""+e.toString()+""):c+=t}else c+=t})),c!==s&&(s=c),a+="["+s+"]",{arg:t.replace(r,""),owner:a,ofResult:s}}return null}(e,t,s);n&&(t=n.arg,r=n.owner,a=n.ofResult,a||(s.owner=r))}if(function(e,t,n){const s=t&&"not"===t.name,a="' with these arguments yield no matches";if(/^(?:-?0n?|-n(?:[+-]0|-\d+)?|(?:0|-\d+)n(?:-\d+)?|(?:0|-\d+)n\+0)$/.test(e)){if(s)return!1;fe(d+n+a)}s&&/^1?n(?:\+[01]|-\d+)?$/.test(e)&&fe(d+n+a+" in ':not()'");return!0}(t=t.replace(/\s+/g,""),n,e)){switch(e){case"nth-child":o=_(e,t,u,r,!1);break;case"nth-last-child":o=_(e,t,f,r,!0);break;case"nth-of-type":r=ne(s,e),o=_(e,t,u,r,!1);break;case"nth-last-of-type":r=ne(s,e),o=_(e,t,f,r,!0);break;default:ue(d+e+"' is not implemented")}a&&s.add(a,!0),o&&s.add(o)}}function _(e,t,n,s,a){let o="";if(/^\d+$/.test(t)){o=M(n,s,{count:parseInt(t)-1,comparison:" = "})}else if("odd"===t)o=B(n,s," + 1",2,1);else if("even"===t)o=B(n,s," + 1",2,0);else{const e=function(e,t){const n=r.exec(e);if(null!==n){const e="-"===n[1],s=D(n[1],n[2],1),a=D(n[3],n[4],0),r=Math.abs(s);let o=a-1,i=t||0===r?" = ":e?" <= ":" >= ",c="none";return t&&(e?null==n[2]||r>=a?i=" <= ":(0!==r||a<2)&&(i=" < ",o++):0!==r&&(i=" >= ")),0===s?c="cnt":(e||1!==a)&&a>0?c=r>1?"both":"cnt":r>1&&(c="mod"),{valueA:r,valueB:a,count:o,comparison:i,type:c}}pe(0,"parseFnNotation",r,e)}(t,a);if(e.valueA){const t=function(e){const t=1-e;return 0===t?"":(t<0?" - ":" + ")+Math.abs(t)}(e.valueB);"mod"===e.type?o=B(n,s,t,e.valueA,0):"cnt"===e.type?o=M(n,s,e):"both"===e.type&&(o=M(n,s,e)+" and "+B(n,s,t,e.valueA,0))}else o=M(n,s,e)}return o}function B(e,t,n,s,a){return`(count(${e}${t})${n}) mod ${s} = ${a}`}function M(e,t,n){return 0===n.count&&/^<?=$/.test(n.comparison.trim())?F(e,t):`count(${e}${t})${n.comparison}${n.count}`}function F(e,t){return`not(${e}${t||"*"})`}function D(e,t,n){return null!=t?+((e&&"-"===e?"-":"")+t):n}function G(e){return e=e?K(e):"normalize-space()",b.translate?H(e):e}function H(e,t){const n="abcdefghjiklmnopqrstuvwxyz";return"translate("+e+", '"+n.toUpperCase()+(t?"":w)+"', '"+n+(t?"":k)+"')"}function J(e,t){return e||fe(d+t+"' has missing argument"),"normalize-space("+(e=K(e,t))+")"}function K(e,t){if((e=e.replace(/\\(?=.)/g,"")).includes("'")){if(!e.includes('"'))return'"'+e+'"';fe((t?d+t+"' string argument":"string")+" contains both '\"' and ''' quotes")}return"'"+e+"'"}function Q(e,t){const n=parseInt(e);if(Number.isInteger(n))return n;fe(d+t+(e?"' argument '"+e+"' is not an integer":"' has missing argument"))}function Y(e,t){n.lastIndex=e;const s=n.exec($);if(null!==s){const n=s[0].replace("|",":").toLowerCase();return"*:"===t.owner?t.owner+=n:t.owner=n,e+s[0].length-1}pe(e,"parseTagName",n)}function ee(e){s.lastIndex=e;const t=s.exec($);if(null!==t)return[e+t[0].length-1,t[0].replace(/^\\00003(?=\d+)/,"")];pe(e,"parseClassValue",s)}function te(e){a.lastIndex=e;const t=a.exec($);if(null!==t){const n=t[1];if(null!=t[2]){const s=re(e+t[0].length-1,$,"lang"===n,"(",")");if(s)return[s.index,n,s.content]}return[e+t[0].length-1,n,""]}pe(e,"parsePseudoClass",a)}function ne(e,t){const n="node()"!==e.owner?e.owner:e.parentNode.parentNode.owner;return t&&"*"==n&&ue(d+t+"' is required an element name; '*' is not implemented."),n}function se(e){i.lastIndex=e;const t=i.exec($);if(null!==t){const n=t[0].toLowerCase();return[e+t[0].length-1,n]}pe(e,"parseAttributeName",i)}function ae(e){c.lastIndex=e;const t=c.exec($);if(null!==t){let n,s;return n=null!=t[1]?t[1]:null!=t[2]?t[2]:t[3],null!=t[4]&&(s=t[4].toLowerCase()),[e+t[0].length-1,n,s]}pe(e,"parseAttributeValue",c)}function re(e,t,n,s,a){let r=!0,o=e,i=0;for(;e<t.length;e++){const c=t[e];if(r)c===s&&(i++,o=e+1),r=!1;else if('"'===c||"'"===c){for(;++e<t.length&&t[e]!==c;);e>=t.length&&he(e,c,"function parseArgument()",t)}else if(c===s)i++;else if(c===a&&0==--i){const s=t.substring(o,e);return{index:e,content:n?s:oe(s)}}}return null}function oe(e){let t=e.length;if(t>1){const n=e[0],s=e[t-1];("'"===n&&"'"===s||'"'===n&&'"'===s)&&t>2&&(e=e.substr(1,t-2))}return e}function ie(e,t){return e+1<y&&$[e+1]===t}function ce(e){null!=e&&e.trim()||fe("argument is null or white space")}function le(e){b.consoleUse||g.includes(e)||(g+=e)}function de(e){"function"==typeof b.printError&&b.printError(e)}function ue(e){throw de(e),new t($,N+1,e)}function fe(e){throw de(e),new t($,"?",e)}function he(e,n,s,a){const r="Unexpected character '";throw de((b.debug?s+". ":"")+r+"<b>"+n+"</b>'\nposition <b>"+(e+1)+"</b>\nstring - '<b>"+a+"</b>'"),new t(a,e+1,s+r+n+"'")}function pe(e,n,s,a){const r=a||$.substring(e),o=" failed to match the string: ";let i="";i=b.debug?`function - <b>${n}()</b>\nRegExp${o}'<b>${r}</b>'\nRegExp - '<b>${s}</b>'`:`Error of ${n.replace(/\B([A-Z])/g,((e,t)=>" "+t.toLowerCase())).replace("parse","parsing")}\nString: '<b>${r}</b>'`,de(i);throw new t($,e+1,`function ${n}() - RegExp '${s}'${o}'${r}'`)}export{A as default};
