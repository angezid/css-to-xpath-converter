/*!*******************************************
* css-to-xpath-converter 1.0.0
* https://github.com/angezid/css-to-xpath-converter
* MIT licensed
* Copyright (c) 2024â€“2025, angezid
*********************************************/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).toXPath=t()}(this,(function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)({}).hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},t.apply(null,arguments)}function n(t,n){return function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,s,o,i=[],c=!0,l=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=s.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(e){l=!0,r=e}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(l)throw r}}return i}}(t,n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){this.axis="",this.separator="",this.owner="",this.parentNode=e,this.previousNode,this.childNodes,this.content,this.addChild=function(e){this.childNodes||(this.childNodes=[]),this.childNodes.push(e)},this.add=function(){for(var e="",t=!1,n=0;n<arguments.length;n++)n===arguments.length-1&&"boolean"==typeof arguments[n]?t=!0:e+=arguments[n];this.content||(this.content=[]),this.content.push({str:e,forbid:t})},this.hasAxis=function(e){if(this.axis===e)return!0;if(this.childNodes)for(var t=0;t<this.childNodes.length;t++)if(this.childNodes[t].hasAxis(e))return!0;return!1},this.clone=function(){var e=new a;return e.owner=this.owner,e.isClone=!0,e},this.toString=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!this.isClone&&(e=this.separator+this.axis+this.owner,this.content)){var t=this.content.length;if(1===t)e+=this.or?this.content[0].str:"["+i(this.content[0].str)+"]";else for(var n=!1,a=0;a<t;a++){var r=this.content[a],s=i(r.str),o=a+1===t;r.forbid?(e+="["+s+"]",n=!1):(e+=(n?" and ":"[")+s,a+1<t&&!this.content[a+1].forbid?(e+=o?"]":"",n=!0):(e+="]",n=!1))}}function i(e){return e.replace(/\x01\[((?:[^"'\x01\x02]|"[^"]*"|'[^']*')+)\]\x02/g,"$1")}return this.childNodes&&this.childNodes.forEach((function(t){e+=t.toString(e)})),e}}function r(e,t,n,a,s){var o=new Error(n,a,s);return o.parser=!0,o.column=t,o.code=e,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,r),o}r.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(r,Error):r.__proto__=Error;var s,o,i,c,l,d,u,f,h,p=new RegExp("(?:[a-zA-Z]+\\|)?(?:[a-zA-Z][^ -,.\\/:-@[-^`{-~]*)|(?:[a-zA-Z]+\\|*)","y"),b=new RegExp("(?:^\\\\00003\\d+)?(?:\\\\[^ ]|[^\\t-,.\\/:-@[-^`{-~])+","y"),g=new RegExp("((?:[a-z]+-)*[a-z]+)(?:([(])|(?=[ ,:+>~!^]|$))","y"),v=/^([+-])?([0-9]+)?n(?:([+-])([0-9]+))?$/,m=new RegExp("(?:(?:\\*|[a-zA-Z]+)\\|)?(?:\\*|[^ -,.\\/:-@[-^`{-~]+)","y"),w=new RegExp("(?:[a-zA-Z]+\\|)?[^ -,.\\/:-@[-^`{-~]+(?=(?:[~^|$!*]?=)|\\])","y"),k=new RegExp("(?:\"([^\"]*)\"|'([^']*)'|((?:\\\\[^ ]|[^ \"'\\]])+))(?: +([siSI]))?(?=\\])","y"),x=Object.freeze({Text:0,PseudoClass:1,AttributeName:2,AttributeValue:3}),y="Pseudo-class ':",N="preceding-sibling::",A="following-sibling::",z="ancestor::",S="\nSystem.Xml.XPath.XPathNavigator doesn't support '*' as a namespace.";function E(e,t,n,a,r){t||pe("':"+r.name+"()' has missing argument"),d.push(u);var s=C(e,t,n,a,r);return u=d.pop(),h=u.length,s}function $(e){for(var t,n=/(?:[^'" ]|"[^"]*"|'[^']*')+|( or )/g;t=n.exec(e);)if(t[1])return!0;return!1}function C(e,t,a,r,s){de(t);var o,i=j(e,null),c=j(i,null),l=s?s.name:"",d=s&&s.predicate,p="not"===l,g=null,v=null,m=null,w=null,k=x.Text,y=!1,E=!0,$=-1,C=u[0];for(h=(u=t).length,(/^[,(]/.test(u)||!l&&/^[>+~^!]/.test(C))&&re(),/[.#[:>+~^!]$/.test(u)&&(C=u[h-1],re(h));++$<h;)if(f=$,C=u[$],k===x.Text){switch((y&&!/[>+~^!.#*:|[@a-zA-Z]/.test(C)||!y&&!/[ ,>+~^!.#*:|[@a-zA-Z]/.test(C))&&be($,C,O(k)+", check="+y,u),s&&/!?[+~]/.test(C)&&l.endsWith("-sibling")&&pe("'"+l+"()' with these arguments has no implementation"),(/[.#:[]/.test(C)||"has"!==l&&c.previousNode&&/[>+~^!]/.test(C))&&(T(a,c,s),L(r,c)),C){case".":var R="";do{var q=n(ne($+1),2);if($=q[0],R+=U("@class",Y(" "+(o=q[1])+" ")),b.lastIndex=$+2,!le($,".")||!b.test(u))break;R+=" and "}while(++$<h);c.add(R),y=!1;break;case"#":var _=n(ne($+1),2);$=_[0],o=_[1],c.add("@id=",Y(o)),y=!1;break;case">":c=p?P(i,c,"parent::"):j(i,c,"child::","/"),y=!0;break;case"+":c=I(i,c,p?N:A,"*","1"),y=!0;break;case"~":c=p?P(i,c,N):j(i,c,A,"/"),y=!0;break;case"^":c=p?P(i,c,"parent::",G(N)):I(i,c,"child::","*","1"),y=!0;break;case"!":le($,"^")?(c=p?P(i,c,"parent::",G(A)):I(i,c,"child::","*","last()"),$++):le($,"+")?(c=I(i,c,p?A:N,"*","1"),$++):le($,">")?(c=p?P(i,c,"child::"):j(i,c,"parent::","/"),$++):le($,"~")?(c=p?P(i,c,A):j(i,c,N,"/"),$++):c=p?P(i,c,"descendant-or-self::"):j(i,c,"ancestor-or-self::","/"),y=!0;break;case"[":g="",v=null,m=null,w=null,k=x.AttributeName;break;case":":le($,":")&&re(1),k=x.PseudoClass;break;case",":$+1>=h&&re(),(i=j(e,i)).or=!0,i.add(d?" or ":" | "),i=j(e,i),c=j(i,null,s?"":a),y=!0;break;case"@":var M=n(V($,a,s,i,c),2);$=M[0],c=M[1],y=!1;break;case"*":T(a,c,s),c.owner="*",y=!1;break;case" ":s?"has-ancestor"===l?c=j(i,c,z," and "):["has-parent","before","after"].includes(l)||l.endsWith("-sibling")?(c.previousNode||(c.axis=z,c.separator=""),c=j(i,c,z," and ")):"not"===l&&"self::"===c.axis?(c.previousNode&&c.previousNode.axis===z&&(c.separator=" and "),c.and=!0,c=P(i,c,z)):c=j(i,c,null,"//"):c=j(i,c,null,"//"),y=!0;break;case"|":if(le($,"|"))re(1);else{var F=n(Z($,a,E,i,c),2);$=F[0],c=F[1]}y=!1;break;case"\\":$++;break;default:/[a-zA-Z]/.test(C)?(c.owner&&re(),T(a,c,s),$=te($,c)):re(),y=!1}E=!1}else if(k===x.AttributeName)switch(C){case"=":w="=",v=null,k=x.AttributeValue;break;case"!":case"~":case"^":case"$":case"*":case"|":le($,"=")?(w=C+"=",$++,v=null,k=x.AttributeValue):"*"===C&&le($,"|")?(g="*:",$++,ue(S)):re();break;case"]":g||he("attrName is null or empty.'"),c.add("@"+g),k=x.Text,y=!1;break;case" ":break;default:var D=n(se($),2);$=D[0],g+=o=D[1]}else if(k===x.AttributeValue)switch(C){case"]":null===v&&he("attrValue is null."),X(g,v,w,m,c),k=x.Text,y=!1;break;case"=":re();break;case" ":break;default:v&&he("attrValue '"+v+"' is already parse: "+u.substring($));var H=n(oe($),3);$=H[0],v=H[1],m=H[2]}else if(k===x.PseudoClass){var J,K="",Q=n(ae($),3);$=Q[0],K=Q[1],J=Q[2],"root"===K?(c.owner=c.separator="",c.axis="//",(c=j(i,c,"ancestor-or-self::")).owner="*",c.add("last()")):(L(r,c),K.startsWith("nth-")?B(K,J,s,c):W(K,J,p,c)),k=x.Text,y=!1}var ee=e.toString();function re(e){be($+(e||0),C,O(k),u)}return(y||k!==x.Text)&&he("Something is wrong: '"+O(k)+"', selector='"+u+"', xpath='"+ee+"'"),ee}function O(e){return"State."+Object.keys(x)[e]}function j(e,t,n,r){var s=new a(e);return e.addChild(s),s.previousNode=t,s.axis=n||"",r&&t.owner&&(s.separator=r),s}function P(e,t,n,a){"node()"===t.owner&&(t.owner="*"),t.axis=n;var r=j(e,t,"self::","/");return a&&r.add(a),r}function I(e,t,n,a,r){var s=j(e,t,n,"/");return s.owner=a,s.add(r,!0),j(e,s,"self::","/")}function T(e,t,n){if(e&&!t.axis&&("self::"!==e||n)){var a=t.parentNode.toString().trim();(0==a.length||R(a))&&(t.axis=e)}}function L(e,t){if(!t.owner){var n="";if(t.previousNode){var a=t.parentNode.toString().trim();if(a.length)if(R(a))n=e||"*";else{var r=a[a.length-1];e?":"===r?n="*":"/"===r&&(n=e):":"!==r&&"/"!==r||(n="*")}}else n=e||"*";t.owner=n}}function R(e){return/(?: or|\|)$/.test(e)}function Z(e,t,n,a,r){if("*"==r.owner)le(e,"*")?(r.owner="*:*",e++):r.owner="*:",ue(S);else if(n&&T(t,r),le(e,"*"))r.owner?r.owner+=":*":(r.owner="*",r.add("not(contains(name(), ':'))")),e++;else{if(e+1<h&&/[a-zA-Z]/.test(u[e+1])){var s=j(a,r,"self::","/");return s.owner="*",[e,s]}r.owner="*:",ue(S)}return[e,r]}function V(e,t,n,a,r){var s=r.parentNode.toString().trim();if(0===s.length)n&&(t="");else if(R(s))t="";else{var o=s[s.length-1];t=":"!==o&&"/"!==o?"/":""}m.lastIndex=e+1;var i=m.exec(u);if(null!==i){var c=j(a,r,t);return c.add("@",i[0].replace("|",":").toLowerCase()),[e+i[0].length,c]}ge(e,"parseAttribute",m)}function X(e,t,n,a,r){if(t.trim()){var o="i"===a||"lang"===e||"type"===e&&"input"==re(r);if(s.standard||"class"!==e){var i=o?K("@"+e):null,c=Y(t);switch(n){case"=":o?r.add(i," = ",J(t)):r.add("@",e,"=",c);break;case"!=":o?r.add("{not(@",e,") or ",i,"!=",J(t),"}"):r.add("{not(@",e,") or @",e,"!=",c,"}");break;case"~=":o?r.add("contains(concat(' ', normalize-space(",i,"), ' '), concat(' ', normalize-space(",J(t),"), ' '))"):r.add("contains(concat(' ', normalize-space(@",e,"), ' '), concat(' ', normalize-space(",c,"), ' '))");break;case"|=":o?r.add("{",i," = ",J(t)," or starts-with(",i,", concat(",J(t),", '-'))}"):r.add("{@",e," = ",c," or starts-with(@",e,", ",Y(t+"-"),")}");break;case"^=":o?r.add("starts-with(",i,", ",J(t),")"):r.add("starts-with(@",e,", ",c,")");break;case"$=":o?r.add(q(i,"@"+e,c,J(t))):r.add(q("@"+e,"@"+e,c,c));break;case"*=":o?r.add("contains(",i,", ",J(t),")"):r.add("contains(@",e,", ",c,")")}}else!function(e,t,n,a){var r=n?K("@class"):"@class",s=e.trim();switch(t){case"=":case"~=":case"!=":s=" "+s+" ";break;case"^=":s=" "+s;break;case"$=":s+=" "}s=n?J(s):Y(s);if("!="===t)a.add("{not(",r,") or not(",U(r,s),")}");else if("*="===t)a.add("contains(",r,", ",s,")");else if("|="===t){var o=n?J(" "+e+" "):Y(" "+e+" "),i=n?J(" "+e+"-"):Y(" "+e+"-");a.add("{",U(r,o)," or ",U(r,i),"}")}else a.add(U(r,s))}(t,n,o,r)}else"="===n?r.add("@",e," = ''"):"!="===n?r.add("{not(@",e,") or @",e," != ''}"):"|="===n?r.add("{@",e," = '' or starts-with(@",e,", '-')}"):r.add("false()",!0)}function q(e,t,n,a){return"substring("+e+", string-length("+t+") - (string-length("+n+") - 1)) = "+a}function U(e,t){return"contains(concat(' ', normalize-space(".concat(e,"), ' '), ").concat(t,")")}function W(e,t,n,a){var r,o,i,c,l="",d="local-name()";switch(e){case"any-link":a.add("(",d," = 'a' or ",d," = 'area') and @href");break;case"external":a.add("(",d," = 'a' or ",d," = 'area') and (starts-with(@href, 'https://') or starts-with(@href, 'http://'))");break;case"contains":a.add("contains(normalize-space(), ",Q(t,e),")");break;case"icontains":a.add("contains(",J(),", ",w(t),")");break;case"empty":a.add("not(*) and not(text())");break;case"dir":c=Y(t);var u=/ltr/.test(c);a.add(u?"{not(ancestor-or-self::*[@dir]) or ":"","ancestor-or-self::*[@dir][1][@dir = ",c,"]",u?"}":"");break;case"first-child":a.add(G(N));break;case"first":n?a.add(t?m(N," <= "):G(N)):a.add(t?"position() <= "+ee(t,e):"1",!t);break;case"first-of-type":i=re(a,e),a.add(G(N,i));break;case"gt":case"skip":n?a.add(m(N," > ")):a.add("position() > ",ee(t,e));break;case"lt":n?a.add(m(N," <= ")):a.add("position() < ",ee(t,e));break;case"eq":case"nth":n?a.add(m(N," = ")):a.add(ee(t,e));break;case"last-child":a.add(G(A));break;case"only-child":a.add("not(",N,"*) and not(",A,"*)");break;case"only-of-type":i=re(a,e),a.add("not(",N,i,") and not(",A,i,")");break;case"text":a.add("@type='text'");break;case"starts-with":a.add("starts-with(normalize-space(), ",Q(t,e),")");break;case"istarts-with":a.add("starts-with(",J(),", ",w(t),")");break;case"ends-with":l=Q(t,e),a.add(q("normalize-space()","normalize-space()",l,l));break;case"iends-with":l=w(t),a.add(q(J(),"normalize-space()",l,l));break;case"is":case"matches":o=E(r=a.clone(),t,"self::","node()",{predicate:!0,name:e}),a.add(o);break;case"not":"self::node()"!==(o=E(r=a.clone(),t,"self::","node()",{name:e}))&&(o=function(e){var t="";return e.childNodes.forEach((function(e){if(e.childNodes){for(var n="",a="",r=!1,s=e.childNodes.length-1;s>=0;s--){var o=e.childNodes[s];r?(o.separator="",n+="["+o.toString(),a+="]"):(o.separator&&(r=!0,o.separator=""),n+=o.toString())}t+=n+a}else t+=e.toString()})),t}(r),a.add("not("+o+")"));break;case"has":o=E(r=a.clone(),t,".//",null,{name:e}),a.add(o);break;case"has-sibling":var f=E(r=a.clone(),t,N,null,{name:e});r.hasAxis(z)&&(f=_(r,N));var h=E(r=a.clone(),t,A,null,{name:e});r.hasAxis(z)&&(h=_(r,A)),a.add("{(",f,") or (",h,")}");break;case"has-parent":v("parent::");break;case"has-ancestor":o=E(r=a.clone(),t,z,null,{name:e}),a.add(o);break;case"after":v("preceding::");break;case"after-sibling":v(N);break;case"before":v("following::");break;case"before-sibling":v(A);break;case"last":n?a.add(t?m(A," <= "):G(A)):a.add(t?"position() > last() - "+ee(t,e):"last()",!t);break;case"last-of-type":i=re(a,e),a.add(G(A,i));break;case"skip-first":n?a.add(t?m(N," > "):G(N)):a.add("position() > ",t?ee(t,e):"1",!t);break;case"skip-last":n?a.add(t?m(A," > "):G(A)):a.add("position() < last()",t?" - "+(ee(t,e)-1):"");break;case"limit":n?a.add(m(N," <= ")):a.add("position() <= ",ee(t,e));break;case"lang":l=function(e,t){for(var n=K("@lang",!0),a=t.split(","),r="",o=0;o<a.length;o++){o>0&&(r+=" or "),r+="ancestor-or-self::*[@lang][1][";var i=/^([a-z]+|\*)(?:-([a-z]+|\*))?(?:-([a-z]+|\*))?/i.exec(ce(a[o].trim()));if(i){if("*"===i[1])if(l(i[2]))r+=u(i[2]+(l(i[3])?"-"+i[3]:""));else{if(!l(i[3]))return"";r+=u(i[3])}else if("*"===i[2]){var c=f(i[1]+"-");l(i[3])?r+="starts-with("+n+", "+c+") and ("+u(i[3])+")":r+=d(i[1])}else{r+=d(i[1]+(i[2]?"-"+i[2]:"")+(l(i[3])?"-"+i[3]:""))}r+="]"}else pe(y+e+"()' has wrong arguments")}function l(e){return e&&"*"!==e}function d(e){var t=f(e);return n+" = "+t+" or starts-with("+n+", concat("+t+", '-'))"}function u(e){var t=f("-"+e+"-"),a=f("-"+e);return"contains(substring("+n+", string-length(substring-before("+n+", "+t+"))), "+t+") or "+q(n,"@lang",a,a)}function f(t){return t=Y(t,e),s.translate?K(t,!0):t}return r}(e,t),l&&a.add("{",l,"}");break;case"range":var p=t.split(",");2!==p.length&&pe(y+e+"(,)' is required two numbers");var b=ee(p[0],e),g=ee(p[1],e);b>=g&&pe(y+e+"("+b+", "+g+")' have wrong arguments"),n?(l=D(N,"*",{count:b-1,comparison:" >= "})+" and ",l+=D(N,"*",{count:g-1,comparison:" <= "}),a.add(l)):a.add("position() >= ",b," and position() <= ",g);break;case"target":a.add("starts-with(@href, '#')");break;case"disabled":a.add("@disabled");break;case"enabled":a.add("not(@disabled)");break;case"selected":a.add(d," = 'option' and @selected");break;case"checked":a.add("(",d," = 'input' and (@type='checkbox' or @type='radio') or ",d," = 'option') and @checked");break;default:he(y+e+"' is not implemented")}function v(n){var r=a.clone(),s=E(r,t,n,null,{name:e});r.hasAxis(z)&&(s=_(r,n)),a.add(s)}function m(n,a){return D(n,"*",{count:ee(t,e)-1,comparison:a})}function w(t){var n=Q(t,e);return s.translate?K(n):n}}function _(e,t){var n="";return e.childNodes.forEach((function(e){if(e.hasAxis(z)){var a="",r=e.childNodes.length-1;e.childNodes.forEach((function(e,n){n<r?a+=e.toString():(e.axis=t,e.separator="",a=e.toString()+"["+a+"]")})),n+=a}else n+=e.toString()})),n}function B(e,t,n,a){de(t);var r,s="*",o="";if("nth-child"===e||"nth-last-child"===e){var i=function(e,t,n){var a,r="*",s=/ +of +(.+)$/,o=s.exec(t);if(null!==o){var i=n.clone();a=E(i,o[1],"self::","node()",{predicate:!0,name:e});var c="";return i.childNodes.forEach((function(e){var t=e.toString();if(e.childNodes){var n=e.childNodes[0];"node()"===n.owner?(n.axis="",n.owner="",c+=""+e.toString()+""):c+=t}else c+=t})),c!==a&&(a=c),r+="["+a+"]",{arg:t.replace(s,""),owner:r,ofResult:a}}return null}(e,t,a);i&&(t=i.arg,s=i.owner,(r=i.ofResult)||(a.owner=s))}if(function(e,t,n){var a=t&&"not"===t.name,r="' with these arguments yield no matches";if(/^(?:-?0n?|-n(?:[+-]0|-\d+)?|(?:0|-\d+)n(?:-\d+)?|(?:0|-\d+)n\+0)$/.test(e)){if(a)return!1;pe(y+n+r)}a&&/^1?n(?:\+[01]|-\d+)?$/.test(e)&&pe(y+n+r+" in ':not()'");return!0}(t=t.replace(/\s+/g,""),n,e)){switch(e){case"nth-child":o=M(e,t,N,s,!1);break;case"nth-last-child":o=M(e,t,A,s,!0);break;case"nth-of-type":s=re(a,e),o=M(e,t,N,s,!1);break;case"nth-last-of-type":s=re(a,e),o=M(e,t,A,s,!0);break;default:he(y+e+"' is not implemented")}r&&a.add(r,!0),o&&a.add(o)}}function M(e,t,n,a,r){var s="";if(/^\d+$/.test(t))s=D(n,a,{count:parseInt(t)-1,comparison:" = "});else if("odd"===t)s=F(n,a," + 1",2,1);else if("even"===t)s=F(n,a," + 1",2,0);else{var o=function(e,t){var n=v.exec(e);if(null!==n){var a="-"===n[1],r=H(n[1],n[2],1),s=H(n[3],n[4],0),o=Math.abs(r),i=s-1,c=t||0===o?" = ":a?" <= ":" >= ",l="none";return t&&(a?null==n[2]||o>=s?c=" <= ":(0!==o||s<2)&&(c=" < ",i++):0!==o&&(c=" >= ")),0===r?l="cnt":(a||1!==s)&&s>0?l=o>1?"both":"cnt":o>1&&(l="mod"),{valueA:o,valueB:s,count:i,comparison:c,type:l}}ge(0,"parseFnNotation",v,e)}(t,r);if(o.valueA){var i=function(e){var t=1-e;return 0===t?"":(t<0?" - ":" + ")+Math.abs(t)}(o.valueB);"mod"===o.type?s=F(n,a,i,o.valueA,0):"cnt"===o.type?s=D(n,a,o):"both"===o.type&&(s=D(n,a,o)+" and "+F(n,a,i,o.valueA,0))}else s=D(n,a,o)}return s}function F(e,t,n,a,r){return"(count(".concat(e).concat(t,")").concat(n,") mod ").concat(a," = ").concat(r)}function D(e,t,n){return 0===n.count&&/^<?=$/.test(n.comparison.trim())?G(e,t):"count(".concat(e).concat(t,")").concat(n.comparison).concat(n.count)}function G(e,t){return"not(".concat(e).concat(t||"*",")")}function H(e,t,n){return null!=t?+((e&&"-"===e?"-":"")+t):n}function J(e){return e=e?Y(e):"normalize-space()",s.translate?K(e):e}function K(e,t){var n="abcdefghjiklmnopqrstuvwxyz";return"translate("+e+", '"+n.toUpperCase()+(t?"":c)+"', '"+n+(t?"":l)+"')"}function Q(e,t){return e||pe(y+t+"' has missing argument"),"normalize-space("+(e=Y(e,t))+")"}function Y(e,t){if((e=e.replace(/\\(?=.)/g,"")).includes("'")){if(!e.includes('"'))return'"'+e+'"';pe((t?y+t+"' string argument":"string")+" contains both '\"' and ''' quotes")}return"'"+e+"'"}function ee(e,t){var n=parseInt(e);if(Number.isInteger(n))return n;pe(y+t+(e?"' argument '"+e+"' is not an integer":"' has missing argument"))}function te(e,t){p.lastIndex=e;var n=p.exec(u);if(null!==n){var a=n[0].replace("|",":").toLowerCase();return"*:"===t.owner?t.owner+=a:t.owner=a,e+n[0].length-1}ge(e,"parseTagName",p)}function ne(e){b.lastIndex=e;var t=b.exec(u);if(null!==t)return[e+t[0].length-1,t[0].replace(/^\\00003(?=\d+)/,"")];ge(e,"parseClassValue",b)}function ae(e){g.lastIndex=e;var t=g.exec(u);if(null!==t){var n=t[1];if(null!=t[2]){var a=ie(e+t[0].length-1,u,"lang"===n,"(",")");if(a)return[a.index,n,a.content]}return[e+t[0].length-1,n,""]}ge(e,"parsePseudoClass",g)}function re(e,t){var n="node()"!==e.owner?e.owner:e.parentNode.parentNode.owner;return t&&"*"==n&&he(y+t+"' is required an element name; '*' is not implemented."),n}function se(e){w.lastIndex=e;var t=w.exec(u);if(null!==t){var n=t[0].toLowerCase();return[e+t[0].length-1,n]}ge(e,"parseAttributeName",w)}function oe(e){k.lastIndex=e;var t,n,a=k.exec(u);if(null!==a)return t=null!=a[1]?a[1]:null!=a[2]?a[2]:a[3],null!=a[4]&&(n=a[4].toLowerCase()),[e+a[0].length-1,t,n];ge(e,"parseAttributeValue",k)}function ie(e,t,n,a,r){for(var s=!0,o=e,i=0;e<t.length;e++){var c=t[e];if(s)c===a&&(i++,o=e+1),s=!1;else if('"'===c||"'"===c){for(;++e<t.length&&t[e]!==c;);e>=t.length&&be(e,c,"function parseArgument()",t)}else if(c===a)i++;else if(c===r&&0==--i){var l=t.substring(o,e);return{index:e,content:n?l:ce(l)}}}return null}function ce(e){var t=e.length;if(t>1){var n=e[0],a=e[t-1];("'"===n&&"'"===a||'"'===n&&'"'===a)&&t>2&&(e=e.substr(1,t-2))}return e}function le(e,t){return e+1<h&&u[e+1]===t}function de(e){null!=e&&e.trim()||pe("argument is null or white space")}function ue(e){s.consoleUse||o.includes(e)||(o+=e)}function fe(e){"function"==typeof s.printError&&s.printError(e)}function he(e){throw fe(e),new r(u,f+1,e)}function pe(e){throw fe(e),new r(u,"?",e)}function be(e,t,n,a){var o="Unexpected character '";throw fe((s.debug?n+". ":"")+o+"<b>"+t+"</b>'\nposition <b>"+(e+1)+"</b>\nstring - '<b>"+a+"</b>'"),new r(a,e+1,n+o+t+"'")}function ge(e,t,n,a){var o=a||u.substring(e),i=" failed to match the string: ";fe(s.debug?"function - <b>".concat(t,"()</b>\nRegExp").concat(i,"'<b>").concat(o,"</b>'\nRegExp - '<b>").concat(n,"</b>'"):"Error of ".concat(t.replace(/\B([A-Z])/g,(function(e,t){return" "+t.toLowerCase()})).replace("parse","parsing"),"\nString: '<b>").concat(o,"</b>'"));var c="function ".concat(t,"() - RegExp '").concat(n,"'").concat(i,"'").concat(o,"'");throw new r(u,e+1,c)}return function(e,n){de(e),s=t({},{axis:".//",consoleUse:!1,standard:!1,removeXPathSpaces:!1,uppercaseLetters:"",lowercaseLetters:"",postprocess:!0,translate:!0,debug:!1},n),o="",i="",d=[];var r,f,p=new a;try{c=s.uppercaseLetters?s.uppercaseLetters.trim():"",l=s.lowercaseLetters?s.lowercaseLetters.trim():"",c.length!==l.length&&pe("Custom letters have different length"),r=function(e){if(s.postprocess){s.removeXPathSpaces&&(e=e.replace(/("[^"]+"|'[^']+')|([,<=>|+-]) +| +(?=[<=>|+-])/g,(function(e,t,n){return t||n||""})));var t=e.split(/(?<!\| *)(\bself::node\(\)\[)/g);e="";for(var n=0;n<t.length;n++)if("self::node()["===t[n]){var a=t[n+1],r=ie(0,"["+a,!0,"[","]");if(r){var o=r.content,i=a.substr(r.index);$(o)||/^(?:\[| *\|)/.test(i)&&!o.endsWith("]")?e+=t[n]:(e+=o+i,n++)}}else e+=t[n];e=(e=(e=e.replace(/([[(])\{((?:[^'"{}]|"[^"]*"|'[^']*')+)\}([\])])/g,"$1$2$3")).replace(/([/:])\*\[self::(\w+)(\[(?:[^"'[\]]|"[^"]*"|'[^']*')+\])?\]/g,"$1$2$3")).replace(/\/child::/g,"/")}return e=e.replace(/(?:[^'"{}]|"[^"]*"|'[^']*')+|([{}])/g,(function(e,t){return t?"{"===t?"(":")":e})),e}(r=C(p,f=function(e){var t=",>+=~^!:([",n=",>+=~^!$]()";h=(u=e).length;for(var a=!1,r=!1,s="\0",o=[],i=0;i<h;i++){var c=u[i];if(" "===c||/\s/.test(c)){if(r)continue;a&&(t.includes(s)?(a=!1,r=!1):r=!0)}else if("\\"===c)(i+1>=h||/\s/.test(u[i+1]))&&be(i,c,"Non-escape character",u),o.push(c,u[++i]);else if("/"===c&&le(i,"*")){var l=f(i+=2,c,!0);-1===l?o.push("/*"):i=l}else if('"'===c||"'"===c){var d=f(i,c,!1);-1!==d?(o.push(u.substring(i,d+1)),i=d):be(i,c,"function normalizeWhiteSpaces()",u),a=!0,s=c}else!r||n.includes(c)||"*"===c&&le(i,"=")||o.push(" "),o.push(c),a=!0,r=!1,s=c}function f(e,t,n){for(;++e<h;)if(u[e]===t){if(n&&"*"!==u[e-1])continue;return e}return-1}return o.join("")}(e),s.axis,null))}catch(e){return e.parser?s.debug&&console.log(e.message,e.code,e.column):console.error(e),{xpath:r,css:f,warning:o,error:e.message}}return{xpath:r,css:f,warning:o,error:i}}}));
